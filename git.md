# git

## 1.git简介

### 1.1 谁创建了git，为了什么？

- `linux`的创始人在壮大`linux`的时候需要收到各地上传的代码，于是商业版本控制系统，最初有公司免费支持。后来社区有人试图破解别人的系统，公司停用，然后他就自己写了个源码管理，就是现在的`git`。
- 总结：牛逼的人就是牛逼

### 1.2 git是什么？

- 分布式版本管理系统

### 1.3 git的特点

- 版本控制：支持多人同时开发代码，解决找回历史代码的问题。（可以使用git快乐多人运动，并且不用担心因为版本更新出现问题无法找到历史代码产生问题）

- 分布式：可以存储在一个仓库中，然后多台计算机可以同时在各个地方进行开发操作。

- 史上最大的同性交友网站：GitHub

  ![](C:\Users\Administrator\Desktop\git学习\imgs\g01.png)

## 2.安装配置

### 2.1 安装配置

- 在`linux`中安装软件使用``sudo apt-get install git``
- 在`liux`中安装`python`包
  - `pip install xxxx` 当前环境安装包
  - `sudo pip install xxxx`全局环境安装包
- 安装`git`的命令 `sudo apt-get install git`
- 检查`git`是否安装好，你直接在命令行输入`git`，安装成功命令行会提示帮助。

### 2.2 配置仓库

- 首先新建一个目录来让git管理这个仓库
- 在这个目录下使用`git init`初始化仓库
- 上述命令完了之后，在仓库地下有一个隐藏文件`.git`
- 在`linux`中使用命令`ls -al`可以查看隐藏文件，隐藏文件在`linux`中都是以`.`开头

### 2.3 版本创建

- 目录下编辑一个`test`文件用于测试 

- 使用命令`git add test`往仓库添加文件，然后使用命令`git commit -m '说明信息'`创建版本。

- 使用`git logo`查看版本的命令

  - 版本的序列号在`commit`后面内容

- `git`的版本工作原理：

  - 创建第一个版本
  - 后面的版本会在这个版本的基础上，对比前一个版本的修改，进行记录

  ![](C:\Users\Administrator\Desktop\git学习\imgs\02.png)

- 每当我们创建一个新的版本，`head`就会指向那个版本。
- 我们可以用`head+指向`来搜寻版本
  - `head^`表示上一个版本，一个`^`表示一个版本
  - `head~1`也是表示上一个版本，也可在`~`后面指定前多少个版本。
- 我们在`git`中更改版本，可以根据上述原理，改变`head`的指向，搜寻所需的版本。
  - 使用`git reset --hard HEAD~n`回滚到某个版本。
  - 使用`git reset --hard 版本号`可以到指定的版本。
  - **注意：版本号是`commit`后面那个内容，不要与版本信息混淆**
- 如果找不到版本的号可以使用`git reflog`查看操作记录。返回内容是每一行开头的内容就是操作的版本序列。

## 3.git基本的操作

### 3.1 什么是工作区？

- `git`帮我们管理的目录地方，叫做工作区

### 3.2 什么是版本库？

- 工作区的隐藏文件`.git`就是git的版本库
- 版本库有一个重要的区域叫做暂存区。

### 3.3 暂存区

- 我们在前面创建版本的时候提交了两个命令。

  - `git add test` 这个是往版本库提交修改命令给到的暂存区
  - `git commit -m 版本信息`这个把暂存区的修改提交给当前的分支

  ![](C:\Users\Administrator\Desktop\git学习\imgs\03.png)

- 在对版本进行修改的时候，我们可以多次进行修改，放入暂存区，然后再统一提交创建版本记录。（提交前可以多次add）
  - 工作区编辑文件
  - 使用`git status`查看工作状态（看到我们的创建修改动作）
  - 使用`git add 文件|目录`添加到暂存区（多个文件用空格隔开）
  - 使用`git commit -m 版本信息`提交暂存区的修改

### 3.4 管理修改

- `git`管理文件的修改，它只会提交暂存区的修改来创建版本。
- 没有提交到暂存区的修改，不会被提交到版本。

### 3.5 撤销修改

- 使用命令`git checkout -- <文件>`撤销工作区的改动
- 刚才在`git`工作区的修改会被撤销。
- 那么你会问改动如果已经加到暂存区了，怎么办？
  - 使用命令`git reset HEAD <文件>`以取消暂存
  - 修改就会取消暂存回到工作区
  - 我们在工作区使用命令`git checkout -- <文件>`撤销修改
- 还有个更牛逼的问题:如果你不小心把错误的修改提交到了版本，怎么办？
  - 被开除，哈哈哈哈哈哈
  - 使用版本控制，回滚到提交前的版本。

### 3.6 对比文件的不同

- 工作区与版本库的文件对比
  - 使用`git diff HEAD -- 文件`
  - 首先会用 `+++`和`---`区分两个文件
    - `-`代表head指定的文件
    - `+`代表工作区指定的文件
  - 相同位置没有表示，独有的会用符号`+-`区分
- 版本库之间的文件比较
  - 使用`git diff HEAD HEAD~2 --文件`对比当前版本和前两个版本的区别
  - 此时`-`代表`HEAD`版本，此时`+`代表`HEAD~2`版本

### 3.7 删除文件

- 我们在使用暂存区之前，都是对工作区的内容进行操作
- 使用`rm 文件 `删除文件
- 删除文件是工作区的改动，我们也可以使用`git checkout --文件`取消删除
- 使用 `git add 文件`或者`git rm 文件`将删除放在暂存区
- 使用`git commit -m 版本信息`提交版本
-  使用命令`git log --pretty=oneline`让`log`以简短的形式展示
- 可以通过恢复版本，恢复文件。但是不要随便删除！
- `git`没有跟踪文件，文件被删除，那你个二笔只有去找软件试着在硬盘上找回来撒！

## 4.分支操作

### 4.1 什么是分支？

- 讲工作中的内容分成多个功能模块，在分支上进行不同功能的开发工作，不影响其他的分支工作，提高开发效率。

  ![](C:\Users\Administrator\Desktop\git学习\imgs\04.png)

- 就像工厂流水线，流水线中互不干扰。
- `git` 中每次版本提交串成一条时间线，这条时间线就是一个分支。
- 严格来说`HEAD`先指向分支`master`,`master`指向版本

### 4.2 创建分支

- 创建一个指针，指向提交，再把`HEAD`指向创建的指针

- 使用`git branch` 查看分支

- 使用`git checkout -b dev`创建并切换到新分支`dev`

  - `git branch <name>`创建分支
  - `git checkout <name>`切换分支

- 这个时候`git系统`会帮我们创建一个指针指向提交，然后将`HEAD`的指向改变，指向先创建的分支`dev`

- 再修改和提交都是在分支上进行操作的

- 实际上切换分支就是改变`head`的指向

  ![](C:\Users\Administrator\Desktop\git学习\imgs\05.png)

  ![](C:\Users\Administrator\Desktop\git学习\imgs\06.png)

  

### 4.3 合并分支

- 通过将`master`指向`dev`当前提交，来合并分支。
- 使用`git merge dev`合并分支（`Fast-forward`快速合并）
- 就是把`master`指向`dev`当前提交

### 4.4 删除分支

- 将指针`dev`删除
- 使用`git branch -d 分支名称`删除分支

### 4.5 什么是分支冲突？

- 两个分支都有了新的提交，并且修改的还是同一份文件。

- 在使用快速合并分支的时候，往往会发生冲突。
- 比如建立一个分支dev修改后提交，然后切换到主分支，修改同一文件修改提交。再使用合并的时候会提示我们有冲突。

### 4.6 如何解决分支冲突？

- 手动进行修改，然后重新提交
- 使用`git log --graph`查看带有分支示意图的日志
- 解决完之后，删除分支。

### 4.7 分支管理策略

- 有时候合并分支不会成功，但是同时也不会引起冲突。
- 这个时候`git`会帮助你合并之后，做一次新的提交。
- 使用命令`git merge --no--ff -m 说明信息`禁用`fast-forward`禁用快速合并。

### 4.8 bug分支

- 在修复`bug`的时候，我们可以新的临时分支来修复，修复完成后合并分支，然后删除分支。
- 当我们在开发时候，需要紧急处理bug，这个时候我们可以使用`git stash`保存工作状态。
- 然后使用临时分支处理bug，然后回到主分支去合并。
- 如果使用快速合并，就看不到合并分支的记录。
- 这个时候就要使用`git merge --no--ff -m`合并分支，这样可以保存分支合并的记录。
- 这个时候可以回到刚才在开发的分支，使用命令`git stash list`列出我们保存的工作环境
- 使用`git stash pop`恢复工作现场

## 5.GitHub

### 5.1 GitHub的作用

- 可以充当一个分布式的中央服务器
- 让多台计算机通过GitHub进行代码的交换

### 5.2 如何使用GitHub

- 访问官网`github.com`

- 注册账户，并且登录。

- 创建仓库

- 添加`ssh`账户

  - 到GitHub设置中去配置`ssh`公钥

  - 来到家目录中使用`vi .gitconfig`

    [user]

    ​	email = 邮箱名字

    ​	name = 名字

  - 执行命令`ssh-keygen -t rsa -C '注册邮箱'`生成`SSHkey`
  - 到`.shh/`中找打`id_rsa.pub`然后使用`cat`命令拿到详细的公钥
  - 复制公钥到GitHub中，完成公钥的添加

### 5.3 克隆项目

- 拿到克隆地址
- 使用`git clone 地址`克隆GitHub上的代码仓库
- 克隆如果出错，尝试下面命令后，再重新克隆
  - `eval "$(ssh-agent -s)"`
  - `ssh-add`

### 5.4 上传分支

- 我们在工作时候一般不会在主分支上面进行开发
- 这个时候需要我们创建并切换到我们自定义的分支上面去
  - 使用命令`git checkout -b 分支名称`
  - 然后在分支上面进行开发
  - 推送到GitHub上
- 使用命令`git push origin 分支名称`

### 5.5 本地分支跟踪远程分支

- 使用命令`git branch --set-upstream-to=origin/远程分支 本地分支`
- 使用`git status`查看分支跟踪是否成成功

### 5.6 从远程分支拉取代码

- 使用命令`git pull origin 分支名`
- 将分支上的代码下载合并到本地的分支

### 5.7 工作中使用GIT

- 项目负责人搭建项目的框架，项目经理将代码放到服务器
- 员工在电脑上生成`SSH公钥`，然后将公钥交给负责人添加到服务器
- 项目经理分发项目代码地址，组员把代码下载到自己的电脑上。
- 创建本地分支，在本地分支上进行每天的开发
- 每个员工开发完成自己的代码之后，都需要将代码发布到远程的分支上面。

- `master`用户保存发布的项目代码
- `dev`保存开发过程中的代码



